<img alt="points bar" align="right" height="36" src="../../blob/badges/.github/badges/points-bar.svg" />

![](https://img.shields.io/badge/Github-Classroom-green.svg) ![C++ Badge](https://img.shields.io/badge/C%2B%2B-00599C?logo=cplusplus&logoColor=fff&style=plastic) ![Build with PlatformIO](https://img.shields.io/badge/build%20with-PlatformIO-orange?logo=data%3Aimage%2Fsvg%2Bxml%3Bbase64%2CPHN2ZyB3aWR0aD0iMjUwMCIgaGVpZ2h0PSIyNTAwIiB2aWV3Qm94PSIwIDAgMjU2IDI1NiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSJ4TWlkWU1pZCI+PHBhdGggZD0iTTEyOCAwQzkzLjgxIDAgNjEuNjY2IDEzLjMxNCAzNy40OSAzNy40OSAxMy4zMTQgNjEuNjY2IDAgOTMuODEgMCAxMjhjMCAzNC4xOSAxMy4zMTQgNjYuMzM0IDM3LjQ5IDkwLjUxQzYxLjY2NiAyNDIuNjg2IDkzLjgxIDI1NiAxMjggMjU2YzM0LjE5IDAgNjYuMzM0LTEzLjMxNCA5MC41MS0zNy40OUMyNDIuNjg2IDE5NC4zMzQgMjU2IDE2Mi4xOSAyNTYgMTI4YzAtMzQuMTktMTMuMzE0LTY2LjMzNC0zNy40OS05MC41MUMxOTQuMzM0IDEzLjMxNCAxNjIuMTkgMCAxMjggMCIgZmlsbD0iI0ZGN0YwMCIvPjxwYXRoIGQ9Ik0yNDkuMzg2IDEyOGMwIDY3LjA0LTU0LjM0NyAxMjEuMzg2LTEyMS4zODYgMTIxLjM4NkM2MC45NiAyNDkuMzg2IDYuNjEzIDE5NS4wNCA2LjYxMyAxMjggNi42MTMgNjAuOTYgNjAuOTYgNi42MTQgMTI4IDYuNjE0YzY3LjA0IDAgMTIxLjM4NiA1NC4zNDYgMTIxLjM4NiAxMjEuMzg2IiBmaWxsPSIjRkZGIi8+PHBhdGggZD0iTTE2MC44NjkgNzQuMDYybDUuMTQ1LTE4LjUzN2M1LjI2NC0uNDcgOS4zOTItNC44ODYgOS4zOTItMTAuMjczIDAtNS43LTQuNjItMTAuMzItMTAuMzItMTAuMzJzLTEwLjMyIDQuNjItMTAuMzIgMTAuMzJjMCAzLjc1NSAyLjAxMyA3LjAzIDUuMDEgOC44MzdsLTUuMDUgMTguMTk1Yy0xNC40MzctMy42Ny0yNi42MjUtMy4zOS0yNi42MjUtMy4zOWwtMi4yNTggMS4wMXYxNDAuODcybDIuMjU4Ljc1M2MxMy42MTQgMCA3My4xNzctNDEuMTMzIDczLjMyMy04NS4yNyAwLTMxLjYyNC0yMS4wMjMtNDUuODI1LTQwLjU1NS01Mi4xOTd6TTE0Ni41MyAxNjQuOGMtMTEuNjE3LTE4LjU1Ny02LjcwNi02MS43NTEgMjMuNjQzLTY3LjkyNSA4LjMyLTEuMzMzIDE4LjUwOSA0LjEzNCAyMS41MSAxNi4yNzkgNy41ODIgMjUuNzY2LTM3LjAxNSA2MS44NDUtNDUuMTUzIDUxLjY0NnptMTguMjE2LTM5Ljc1MmE5LjM5OSA5LjM5OSAwIDAgMC05LjM5OSA5LjM5OSA5LjM5OSA5LjM5OSAwIDAgMCA5LjQgOS4zOTkgOS4zOTkgOS4zOTkgMCAwIDAgOS4zOTgtOS40IDkuMzk5IDkuMzk5IDAgMCAwLTkuMzk5LTkuMzk4em0yLjgxIDguNjcyYTIuMzc0IDIuMzc0IDAgMSAxIDAtNC43NDkgMi4zNzQgMi4zNzQgMCAwIDEgMCA0Ljc0OXoiIGZpbGw9IiNFNTcyMDAiLz48cGF0aCBkPSJNMTAxLjM3MSA3Mi43MDlsLTUuMDIzLTE4LjkwMWMyLjg3NC0xLjgzMiA0Ljc4Ni01LjA0IDQuNzg2LTguNzAxIDAtNS43LTQuNjItMTAuMzItMTAuMzItMTAuMzItNS42OTkgMC0xMC4zMTkgNC42Mi0xMC4zMTkgMTAuMzIgMCA1LjY4MiA0LjU5MiAxMC4yODkgMTAuMjY3IDEwLjMxN0w5NS44IDc0LjM3OGMtMTkuNjA5IDYuNTEtNDAuODg1IDIwLjc0Mi00MC44ODUgNTEuODguNDM2IDQ1LjAxIDU5LjU3MiA4NS4yNjcgNzMuMTg2IDg1LjI2N1Y2OC44OTJzLTEyLjI1Mi0uMDYyLTI2LjcyOSAzLjgxN3ptMTAuMzk1IDkyLjA5Yy04LjEzOCAxMC4yLTUyLjczNS0yNS44OC00NS4xNTQtNTEuNjQ1IDMuMDAyLTEyLjE0NSAxMy4xOS0xNy42MTIgMjEuNTExLTE2LjI4IDMwLjM1IDYuMTc1IDM1LjI2IDQ5LjM2OSAyMy42NDMgNjcuOTI2em0tMTguODItMzkuNDZhOS4zOTkgOS4zOTkgMCAwIDAtOS4zOTkgOS4zOTggOS4zOTkgOS4zOTkgMCAwIDAgOS40IDkuNCA5LjM5OSA5LjM5OSAwIDAgMCA5LjM5OC05LjQgOS4zOTkgOS4zOTkgMCAwIDAtOS4zOTktOS4zOTl6bS0yLjgxIDguNjcxYTIuMzc0IDIuMzc0IDAgMSAxIDAtNC43NDggMi4zNzQgMi4zNzQgMCAwIDEgMCA0Ljc0OHoiIGZpbGw9IiNGRjdGMDAiLz48L3N2Zz4=)

[![platformio](../../blob/badge_format/.github/badges/badge_format.svg)](../../actions)

# TP POO : PlatformIO

- [TP POO : PlatformIO](#tp-poo--platformio)
  - [PlatormIO et Visual Studio Code](#platormio-et-visual-studio-code)
    - [PlatformIO CLI](#platformio-cli)
    - [Créer un projet](#créer-un-projet)
    - [Éditer des fichiers](#éditer-des-fichiers)
    - [Fabriquer un projet](#fabriquer-un-projet)
    - [Programmer le système embarqué](#programmer-le-système-embarqué)
    - [Nettoyer un projet](#nettoyer-un-projet)
    - [Monitorer](#monitorer)
    - [Les bibliothèques](#les-bibliothèques)
  - [Le langage C++](#le-langage-c)
  - [Travail demandé](#travail-demandé)
    - [Une classe Point](#une-classe-point)
  - [Tests unitaires](#tests-unitaires)
  - [Intégration continue (Github Actions) et test distant](#intégration-continue-github-actions-et-test-distant)

**Les objectifs de ce TP sont de s’initier à la programmation orientée objet en C++ avec [PlatformIO](https://platformio.org/).**

> Pour les enseignants, ceci est un "petit" devoir pour [Github Classroom](https://btssn-lasalle84.github.io/guides-developpement-logiciel/guide-classroom.html). Il montre l'utilisation des tests unitaires, la notation automatique et l'insertion d'un badge pour l'affichage de la note.

Voir aussi : https://github.com/tvaira/github-classroom

## PlatormIO et Visual Studio Code

[PlatormIO](https://platformio.org/) est un outil professionnel multi-plateforme, multi-architecture et multi-framework destiné aux ingénieurs en systèmes embarqués et aux développeurs de logiciels qui écrivent des applications pour ce type de système.

Liens :

- https://docs.platformio.org/en/latest/
- https://docs.platformio.org/en/latest/what-is-platformio.html
- http://tvaira.free.fr/dev/tutoriel/platformio.html
- http://tvaira.free.fr/dev/tutoriel/platformio-cli.html

[Visual Studio Code](https://code.visualstudio.com/) est un éditeur de code source extensible et disponible pour Windows, macOS et Linux.

Liens :

- https://code.visualstudio.com/docs
- https://platformio.org/install/ide?install=vscode
- https://docs.platformio.org/en/latest/integration/ide/vscode.html#quick-start
- http://tvaira.free.fr/projets/activites/activite-visualcode.html

### PlatformIO CLI

[PlatformIO CLI](https://docs.platformio.org/en/stable/core/index.html) fournit l'utilitaire `platformio` (ou son alias `pio`) pour programmer des systèmes embarqués (Arduino UNO, ESP32, etc.).

Dans un terminal :

```sh
$ platformio --version
PlatformIO Core, version 6.1.4

$ pio --version
PlatformIO Core, version 6.1.4

$ platformio --help
$ pio --help
```

_Remarque :_ `pio` est un alias de la commande `platformio`.

Guide : https://docs.platformio.org/en/stable/core/userguide/index.html

### Créer un projet

- Créer un répertoire pour le projet

```sh
$ mkdir -p nom-projet
$ cd nom-projet
```

- Initialiser le projet pour une carte et un _framework_

```sh
$ pio project init --board uno --project-option="framework=arduino"
...
include : Put project header files here
lib : Put here project specific (private) libraries
src : Put project source files here
platformio.ini : Project Configuration File
...
Project has been successfully initialized! Useful commands:
pio run : process/build project from the current directory
pio run --target upload or pio run -t upload : upload firmware to a target
pio run --target clean : clean project (remove compiled files)
...
```

- Voir l'état initial du projet

```sh
$ ls -l
drwxrwxr-x 2 tv tv 4096 sept. 27 07:59 include
drwxrwxr-x 2 tv tv 4096 sept. 27 07:59 lib
-rw-rw-r-- 1 tv tv  427 sept. 27 07:59 platformio.ini
drwxrwxr-x 2 tv tv 4096 sept. 27 07:59 src
drwxrwxr-x 2 tv tv 4096 sept. 27 07:59 test

$ cat platformio.ini
[env:uno]
platform = atmelavr
board = uno
framework = arduino
```

### Éditer des fichiers

Les **fichiers sources** sont à placer dans `src/`, par exemple `src/main.cpp` pour un _framework_ Arduino :

```cpp
#include <Arduino.h>

void setup()
{
}

void loop()
{
}
```

### Fabriquer un projet


```sh
$ pio run -v
```

### Programmer le système embarqué

```sh
$ pio run -t upload -v
```

Les fichiers générés pendant la fabrication sont stockés dans un répertoire `.pio`.

:warning: Ces fichiers ne doivent jamais être conservés dans un dépôt `git`. Le plus simple est de "demander" à `git` de les ignorer. Pour cela, il suffit d'ajouter `.pio` dans le fichier `.gitignore` qui est situé à la racine du dépôt.

### Nettoyer un projet

Les fichiers générés à la fabrication peuvent être supprimés avec la commande suivante :

```sh
$ pio run --target clean
```

### Monitorer

```sh
$ platformio device list
$ platformio device monitor --help
```

Des informations spécifiques peuvent être conservées dans le fichier du projet `platformio.ini` :

```ini
[env:uno]
platform = atmelavr
board = uno
framework = arduino

monitor_speed = 115200
```

> Il est possible de spécifier le port série avec `monitor_port = /dev/ttyUSB0` (par exemple pour GNU/Linux).

### Les bibliothèques

La gestion des bibliothèques sous PlatormIO est contrôlée par la commande `pio pkg`

_Remarque :_ `pio lib` est considérée maintenant comme obsolète. Elle disparaîtra probablement dans les nouvelles versions.

Les bibliothèques peuvent être installées :

- globalement (dans le dossier d'installation de PlatformIO)

```sh
$ pio lib -g list
$ pio pkg list --global --only-libraries
...
```

- localement (dans le dossier du projet)

```sh
$ pio lib list
$ pio pkg list --only-libraries
```

Et de manière générale : `pio pkg list`

Les commandes utiles :

- rechercher une bibliothèque :

```sh
$ pio pkg search xxx
```

- voir les informations sur une bibliothèque :

```sh
$ pio pkg show xxx
```

- installer une bibliothèque (avec l'option `--global` pour l'installer globalement) :

```sh
$ pio pkg install xxx
```

Des informations spécifiques sur les bibliothèques peuvent être conservées avec `lib_deps` dans le fichier du projet `platformio.ini`, par exemple :

```ini
[env:uno]
platform = atmelavr
board = uno
framework = arduino

lib_deps =
  fastled/FastLED @ ^3.4.0
```

_Remarque :_ Il est possible de créer ses propres bibliothèques à l’intérieur du projet dans le dossier `lib`. Le principe est de créer un sous-répertoire qui porte le même nom que le nom des fichiers sources (`.h` et `.cpp`). Il est aussi possible de placer des fichiers d’entête (`.h`) dans le dossier `include` du projet.

## Le langage C++

[C++](https://fr.wikipedia.org/wiki/C%2B%2B) est un langage de programmation compilé permettant la programmation sous de multiples paradigmes (comme la programmation procédurale, __orientée objet__ ou générique). Ses bonnes performances, et sa compatibilité avec le C en font un des langages de programmation les plus utilisés dans les applications où la performance est critique.

Créé initialement par __Bjarne Stroustrup__ dans les années 1980, le langage C++ est aujourd'hui normalisé par l'ISO. Sa première normalisation date de __1998__ (ISO/CEI 14882:1998), ensuite amendée par l'erratum technique de __2003__ (ISO/CEI 14882:2003). Une importante mise à jour a été ratifiée et publiée par l'ISO en septembre __2011__ sous le nom de ISO/IEC 14882:2011, ou __C++11__. Depuis, des mises à jour sont publiées régulièrement : en __2014__ (ISO/CEI 14882:2014 ou __C++14__) puis en __2017__ (ISO/CEI 14882:2017 ou __C++17__). [source : [wikipedia.org](https://fr.wikipedia.org/wiki/C%2B%2B)]

Les changements du langage C++ concernent aussi bien le langage initial que la bibliothèque standard.

_Remarque :_ La bibliothèque standard du C++ (_C++ Standard Library_) est une bibliothèque de classes et de fonctions standardisées selon la norme ISO pour le langage C++. Elle contient aussi la bibliothèque standard du C. Une des principales briques de la bibliothèque standard du C++ est sans aucun doute la __STL__ (_Standard Template Library_), à tel point qu'il y a souvent confusion entre les deux.

Dans l'index de popularité des langages [TIOBE](https://www.tiobe.com/tiobe-index/), le C représente 16,2 % (première place) et le C++ 7,6 % (quatrième place) en novembre 2020.

Lien : [www.cplusplus.com](http://www.cplusplus.com/reference/)

« Hello, world »

Voici l'exemple de _Hello world_ donné dans "_The C++ Programming Language, Third Edition_" de **Bjarne Stroustrup** :

```cpp
#include<iostream>

int main()
{
    std::cout << "Hello, new world!\n";
}
```

## Travail demandé

### Une classe Point

On souhaite manipuler des **points**. Pour cela, nous allons définir le concept **Point** :

> Un point est défini par son abscisse (`x`) et son ordonnée (`y`). L’abscisse et l’ordonnée d’un point sont des réels (`float`).

On en sait suffisamment pour **modéliser une classe `Point`** :

```cpp
#ifndef POINT_H
#define POINT_H

class Point
{
   private:
      float x;
      float y;

   public:
      // TODO Constructeurs

      // TODO Destructeur

      // TODO Accesseurs et mutateurs

      // TODO Services
};

#endif //POINT_H
```

:memo: Lorsqu'on modélise une nouvelle classe, on commence toujours par identifier ses **caractéristiques** afin de déterminer le **nom et le type des ses attributs**. C'est seulement ensuite que l'on s'attache à son comportement.

La **programmation orientée objet (POO)** nous oblige à complèter le squelette de cette classe :

- La classe `Point` devra disposer de deux **constructeurs** : un constructeur par défaut qui initialisera les attributs `x` et `y` à zéro et un constructeur d'initialisation qui recevra en paramètres l’abscisse et l’ordonnée du point à initialiser.

- Tous les attributs de la classe `Point` seront **privés** par respect du principe d’encapsulation. On veut néanmoins pouvoir connaître son abscisse et son ordonnée, et éventuellement les modifier. Il faudra donc créer les **accesseurs** et mutateurs correspondants.

- Un point pourra s’afficher. On aura donc une **méthode publique** `affiche()` qui produira un affichage de ce type : `<x,y>`

- On doit aussi pouvoir calculer la distance entre 2 points (`calculeDistance()`) et le milieu de 2 points (`determinePointMilieu()`).

:memo: Une méthode publique est un **service** rendu à l'utilisateur de l'objet.

Le code source à compléter est situé dans `lib/Point/`.

Q1. Constructeur par défaut

Q2. Constructeur d'initialisation

Q3. Accesseurs et mutateurs

Q4. Affiche les coordonnées d'un point

Q5. Calcul de la distance entre 2 points

Q6. Calcul du point milieu entre 2 points"

## Tests unitaires

Les tests unitaires sont supportés par [PlatformIO](https://platformio.org/) avec le _framework_ [Unity](https://docs.platformio.org/en/latest/advanced/unit-testing/frameworks/unity.html) (par défaut) :

- [Unit Testing](https://docs.platformio.org/en/latest/advanced/unit-testing/index.html)
- [Exemples](https://docs.platformio.org/en/latest/advanced/unit-testing/introduction.html)
- [Unity Assertions Reference](https://github.com/ThrowTheSwitch/Unity/blob/master/docs/UnityAssertionsReference.md)
- [Assertions CheatSheet (PDF)](https://github.com/ThrowTheSwitch/Unity/blob/master/docs/UnityAssertionsCheatSheetSuitableforPrintingandPossiblyFraming.pdf)

Les tests peuvent être réalisés :

- en local (on utilise alors la plateforme `native`)

```ini
[env:native]
platform = native
test_filter = test_point
```

Les tests unitaires sont placés dans le répertoire `test`. Ici, dans `test/test_point/` :

```cpp
#include <unity.h>

#include "Point.h" // La classe Point

void setUp(void)
{
    // set stuff up here
}

void tearDown(void)
{
    // clean stuff up here
}

// "Q1 : Constructeur par défaut"
void test_unitaire_q1()
{
    Point p0;

    TEST_ASSERT_EQUAL_FLOAT(p0.getX(), 0.);
    TEST_ASSERT_EQUAL_FLOAT(p0.getY(), 0.);
}

// "Q2 : Constructeur d'initialisation"
void test_unitaire_q2()
{
    Point p1(1., 2.);
    Point p2(4., 0.);

    TEST_ASSERT_EQUAL_FLOAT(p1.getX(), 1.);
    TEST_ASSERT_EQUAL_FLOAT(p1.getY(), 2.);
    TEST_ASSERT_EQUAL_FLOAT(p2.getX(), 4.);
    TEST_ASSERT_EQUAL_FLOAT(p2.getY(), 0.);
}

// "Q3 : Accesseurs et mutateurs"
void test_unitaire_q3()
{
    Point p0;

    p0.setX(5.5);
    TEST_ASSERT_EQUAL_FLOAT(p0.getX(), 5.5);
    p0.setY(6.5);
    TEST_ASSERT_EQUAL_FLOAT(p0.getY(), 6.5);
}

// "Q4 : Affiche les coordonnées d'un point"
void test_unitaire_q4()
{
    Point p0;

    p0.affiche(); // la méthode existe
    TEST_IGNORE();
}

// "Q5 : Calcul de la distance entre 2 points"
void test_unitaire_q5()
{
    Point p1(1., 2.);
    Point p2(4., 0.);

    double distance = p1.calculeDistance(p2);
    TEST_ASSERT_EQUAL_FLOAT(distance, 3.605551275);
}

// "Q6 : Calcul du point milieu entre 2 points"
void test_unitaire_q6()
{
    Point p1(1., 2.);
    Point p2(4., 0.);

    Point pointMilieu = p1.determinePointMilieu(p2);
    TEST_ASSERT_EQUAL_FLOAT(pointMilieu.getX(), 2.5);
    TEST_ASSERT_EQUAL_FLOAT(pointMilieu.getY(), 1.);
}

int main()
{
    UNITY_BEGIN(); // IMPORTANT LINE!
    RUN_TEST(test_unitaire_q1);
    RUN_TEST(test_unitaire_q2);
    RUN_TEST(test_unitaire_q3);
    RUN_TEST(test_unitaire_q4);
    RUN_TEST(test_unitaire_q5);
    RUN_TEST(test_unitaire_q6);
    return UNITY_END(); // stop unit testing
}
```

Tests unitaires pour les questions Q1, Q2, Q3, Q4, Q5 et Q6 :

```cpp
$ pio test -e native
Verbosity level can be increased via `-v, -vv, or -vvv` option
Collected 8 tests

Processing test_point in native environment
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Building...
Testing...
test/test_point/test_point_main.cpp:80: test_unitaire_q1        [PASSED]
test/test_point/test_point_main.cpp:81: test_unitaire_q2        [PASSED]
test/test_point/test_point_main.cpp:82: test_unitaire_q3        [PASSED]
test/test_point/test_point_main.cpp:53: test_unitaire_q4        [SKIPPED]
test/test_point/test_point_main.cpp:84: test_unitaire_q5        [PASSED]
test/test_point/test_point_main.cpp:85: test_unitaire_q6        [PASSED]
---------------------------------------------------------------------------------------------- native:test_point [PASSED] Took 0.68 seconds ----------------------------------------------------------------------------------------------

================================================================================================================ SUMMARY ================================================================================================================
Environment    Test        Status    Duration
-------------  ----------  --------  ------------
native         test_point  PASSED    00:00:00.676
========================================================================================== 6 test cases: 1 skipped, 5 succeeded in 00:00:00.676 ==========================================================================================
```

Test unitaire pour une question Qx :

```cpp
$ pio test -e q1
Verbosity level can be increased via `-v, -vv, or -vvv` option
Collected 8 tests

Processing test_point_q1 in q1 environment
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Building...
Testing...
test/test_point_q1/test_point_main.cpp:27: test_unitaire_q1     [PASSED]
---------------------------------------------------------------------------------------------- q1:test_point_q1 [PASSED] Took 0.28 seconds ----------------------------------------------------------------------------------------------

================================================================================================================ SUMMARY ================================================================================================================
Environment    Test           Status    Duration
-------------  -------------  --------  ------------
q1             test_point_q1  PASSED    00:00:00.282
=============================================================================================== 1 test cases: 1 succeeded in 00:00:00.282 ===============================================================================================
```

- en embarqué (ici, on utilise un ESP32 avec le _framework_ Arduino)

```ini
[env:lolin32]
platform = espressif32
board = lolin32
framework = arduino
lib_deps =
test_filter = test_point_esp32
upload_port = /dev/ttyUSB0
upload_speed = 115200
monitor_port = /dev/ttyUSB0
monitor_speed = 115200
```

Les tests unitaires sont placés dans le répertoire `test`. Ici, dans `test/test_point_esp32/` :

```cpp
#include <Arduino.h>
#include <unity.h>

#include "Point.h" // La classe Point

void setUp(void)
{
    // set stuff up here
}

void tearDown(void)
{
    // clean stuff up here
}

// "Q1 : Constructeur par défaut"
void test_unitaire_q1()
{
    Point p0;

    TEST_ASSERT_EQUAL_FLOAT(p0.getX(), 0.);
    TEST_ASSERT_EQUAL_FLOAT(p0.getY(), 0.);
}

// "Q2 : Constructeur d'initialisation"
void test_unitaire_q2()
{
    Point p1(1., 2.);
    Point p2(4., 0.);

    TEST_ASSERT_EQUAL_FLOAT(p1.getX(), 1.);
    TEST_ASSERT_EQUAL_FLOAT(p1.getY(), 2.);
    TEST_ASSERT_EQUAL_FLOAT(p2.getX(), 4.);
    TEST_ASSERT_EQUAL_FLOAT(p2.getY(), 0.);
}

// "Q3 : Accesseurs et mutateurs"
void test_unitaire_q3()
{
    Point p0;

    p0.setX(5.5);
    TEST_ASSERT_EQUAL_FLOAT(p0.getX(), 5.5);
    p0.setY(6.5);
    TEST_ASSERT_EQUAL_FLOAT(p0.getY(), 6.5);
}

// "Q4 : Affiche les coordonnées d'un point"
void test_unitaire_q4()
{
    Point p0;

    p0.affiche(); // la méthode existe
    TEST_IGNORE();
}

// "Q5 : Calcul de la distance entre 2 points"
void test_unitaire_q5()
{
    Point p1(1., 2.);
    Point p2(4., 0.);

    double distance = p1.calculeDistance(p2);
    TEST_ASSERT_EQUAL_FLOAT(distance, 3.605551275);
}

// "Q6 : Calcul du point milieu entre 2 points"
void test_unitaire_q6()
{
    Point p1(1., 2.);
    Point p2(4., 0.);

    Point pointMilieu = p1.determinePointMilieu(p2);
    TEST_ASSERT_EQUAL_FLOAT(pointMilieu.getX(), 2.5);
    TEST_ASSERT_EQUAL_FLOAT(pointMilieu.getY(), 1.);
}

void setup()
{
    UNITY_BEGIN(); // IMPORTANT LINE!
    RUN_TEST(test_unitaire_q1);
    RUN_TEST(test_unitaire_q2);
    RUN_TEST(test_unitaire_q3);
    RUN_TEST(test_unitaire_q4);
    RUN_TEST(test_unitaire_q5);
    RUN_TEST(test_unitaire_q6);
    UNITY_END(); // stop unit testing
}

void loop()
{
}
```

Tests unitaires pour les questions Q1, Q2, Q3, Q4, Q5 et Q6 sur un **ESP32** :

```cpp
$ pio test -e lolin32
Verbosity level can be increased via `-v, -vv, or -vvv` option
Collected 8 tests

Processing test_point_esp32 in lolin32 environment
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Building & Uploading...
Testing...
If you don't see any output for the first 10 secs, please reset board (press reset button)

test/test_point_esp32/test_point_main.cpp:81: test_unitaire_q1  [PASSED]
test/test_point_esp32/test_point_main.cpp:82: test_unitaire_q2  [PASSED]
test/test_point_esp32/test_point_main.cpp:83: test_unitaire_q3  [PASSED]
test/test_point_esp32/test_point_main.cpp:54: test_unitaire_q4  [SKIPPED]
test/test_point_esp32/test_point_main.cpp:85: test_unitaire_q5  [PASSED]
test/test_point_esp32/test_point_main.cpp:86: test_unitaire_q6  [PASSED]
------------------------------------------------------------------------------------------ lolin32:test_point_esp32 [PASSED] Took 31.35 seconds ------------------------------------------------------------------------------------------

================================================================================================================ SUMMARY ================================================================================================================
Environment    Test              Status    Duration
-------------  ----------------  --------  ------------
lolin32        test_point_esp32  PASSED    00:00:31.347
========================================================================================== 6 test cases: 1 skipped, 5 succeeded in 00:00:31.347 ==========================================================================================
```

## Intégration continue (Github Actions) et test distant

Liens :

- https://github.com/btssn-lasalle84/github-actions-platformio
- https://piolabs.com/blog/insights/unit-testing-part-3.html

---
Thierry Vaira [**[thierry(dot)vaira(at)gmail(dot)com](mailto:thierry.vaira@gmail.com)**]
